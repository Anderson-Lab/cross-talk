CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d1_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d2_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d3_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d4_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d5_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/d6_descriptions.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Description {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
