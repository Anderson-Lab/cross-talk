CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/texts.pdfs.psychology.and.biomechanics.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Paper {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/texts.pdfs.psychology.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Paper {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/texts.pdfs.biomechanics.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Paper {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
CALL apoc.periodic.iterate(
  "LOAD CSV WITH HEADERS FROM 'file:/texts.pdfs.neither.psychology.nor.biomechanics.annotated/contents.MESH.csv' AS row
   RETURN row",
  "MERGE (a:Paper {uri: row.uri})
  WITH a

  CALL apoc.load.json(a.uri)
  YIELD value

  UNWIND value.contents AS text

  WITH a,
       value.title AS title,
       value.contents AS text

  SET a.body = text , a.title = title
  RETURN a;",
  {batchSize: 1, parallel: false}
)
YIELD batches, total, timeTaken, committedOperations
RETURN batches, total, timeTaken, committedOperations;
